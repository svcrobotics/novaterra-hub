<li>
  <% if node[:type] == :folder %>
    <details class="ml-2 group">
      <summary class="cursor-pointer text-blue-600 font-semibold hover:underline">
        üìÅ <%= node[:name] %>
      </summary>
      <ul class="pl-4">
        <% node[:children].sort_by { |child| child[:name].downcase }.each do |child| %>
          <%= render partial: "file_node", locals: { node: child } %>
        <% end %>
      </ul>
    </details>
  <% else %>
    <% icon = "üìÑ" %>
    <% ext = File.extname(node[:name]).downcase %>
    <% icon =
      case ext
      when ".rb" then "üü•"
      when ".erb", ".html.erb" then "üß©"
      when ".js" then "üü®"
      when ".ts" then "üî∑"
      when ".html", ".htm" then "üåê"
      when ".css", ".scss", ".sass" then "üé®"
      when ".yml", ".yaml" then "‚öôÔ∏è"
      when ".json" then "üßæ"
      when ".md" then "üìò"
      when ".txt" then "üìÑ"
      when ".xml" then "üß∑"
      when ".csv" then "üìä"
      when ".pdf" then "üìï"
      when ".png", ".jpg", ".jpeg", ".gif", ".svg", ".webp" then "üñºÔ∏è"
      when ".env" then "üå±"
      when ".lock" then "üîí"
      when ".log" then "üìù"
      when ".sh", ".bash", ".zsh" then "üíª"
      when ".sql" then "üóÑÔ∏è"
      when ".db" then "üß¨"
      when ".zip", ".tar", ".gz", ".rar" then "üóúÔ∏è"
      else "üìÑ"
      end
    %>

    <%= link_to ide_path(file: node[:path], opened_files: @opened_files&.join(',')), 
              class: "block text-sm text-gray-700 hover:text-blue-500 pl-6", 
              data: { turbo: false } do %>
      <%= "#{icon} #{node[:name]}" %>
    <% end %>
  <% end %>
</li>
